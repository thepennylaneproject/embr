# Embr Platform - Staging Environment Variables
# Configure these in Railway/Vercel environment settings

# ==============================================
# APPLICATION
# ==============================================
NODE_ENV=staging
PORT=3001
API_URL=https://api-staging.embr.app
WEB_URL=https://staging.embr.app
MOBILE_URL=https://staging.embr.app

# ==============================================
# DATABASE
# ==============================================
# Railway PostgreSQL (automatically provided)
DATABASE_URL=${{Railway.DATABASE_URL}}
DIRECT_URL=${{Railway.DIRECT_URL}}

# Or manually set:
# DATABASE_URL="postgresql://user:password@host:port/database?schema=public&connection_limit=5&pool_timeout=10"
# DIRECT_URL="postgresql://user:password@host:port/database?schema=public"

# ==============================================
# REDIS
# ==============================================
# Railway Redis (automatically provided) or Upstash
REDIS_URL=${{Railway.REDIS_URL}}

# Or manually set:
# REDIS_URL=redis://default:password@host:port

# ==============================================
# AUTHENTICATION
# ==============================================
# IMPORTANT: Use different secrets than development
JWT_SECRET=CHANGE_ME_32_CHARS_MINIMUM_STAGING
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=CHANGE_ME_32_CHARS_MINIMUM_REFRESH_STAGING
JWT_REFRESH_EXPIRES_IN=30d

# Google OAuth (Staging Credentials)
GOOGLE_CLIENT_ID=staging_google_client_id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=staging_google_client_secret
GOOGLE_CALLBACK_URL=https://api-staging.embr.app/v1/auth/google/callback

# ==============================================
# AWS SERVICES
# ==============================================
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=STAGING_AWS_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=STAGING_AWS_SECRET_KEY
AWS_S3_BUCKET=embr-staging-uploads
AWS_S3_URL=https://embr-staging-uploads.s3.amazonaws.com

# ==============================================
# VIDEO PROCESSING (MUX)
# ==============================================
MUX_TOKEN_ID=staging_mux_token_id
MUX_TOKEN_SECRET=staging_mux_token_secret
MUX_WEBHOOK_SECRET=staging_mux_webhook_secret

# ==============================================
# PAYMENTS (STRIPE)
# ==============================================
# Use Stripe test mode keys for staging
STRIPE_SECRET_KEY=sk_test_staging_stripe_secret_key
STRIPE_PUBLISHABLE_KEY=pk_test_staging_stripe_publishable_key
STRIPE_WEBHOOK_SECRET=whsec_staging_webhook_secret
PLATFORM_FEE_PERCENTAGE=10

# ==============================================
# JOBS API (RELEVNT)
# ==============================================
RELEVNT_API_KEY=staging_relevnt_api_key
RELEVNT_API_URL=https://api.relevnt.com/v1

# ==============================================
# EMAIL (SendGrid or similar)
# ==============================================
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=apikey
SMTP_PASSWORD=SG.staging_sendgrid_api_key
EMAIL_FROM=noreply@embr.app

# ==============================================
# FRONTEND URLS (for CORS)
# ==============================================
ALLOWED_ORIGINS=https://staging.embr.app,https://api-staging.embr.app

# ==============================================
# ANALYTICS & MONITORING
# ==============================================
# Sentry for error tracking
SENTRY_DSN=https://staging_sentry_dsn@sentry.io/project_id
SENTRY_ENVIRONMENT=staging

# Google Analytics
NEXT_PUBLIC_GA_ID=G-STAGING-ID

# ==============================================
# RATE LIMITING
# ==============================================
RATE_LIMIT_TTL=60
RATE_LIMIT_MAX=100

# ==============================================
# FILE UPLOAD LIMITS
# ==============================================
MAX_FILE_SIZE=104857600 # 100MB
MAX_VIDEO_DURATION=180 # 3 minutes
ALLOWED_IMAGE_TYPES=image/jpeg,image/png,image/gif,image/webp
ALLOWED_VIDEO_TYPES=video/mp4,video/quicktime,video/x-msvideo

# ==============================================
# BULL QUEUE
# ==============================================
QUEUE_NAME=embr_staging_jobs
QUEUE_PREFIX=embr_staging

# ==============================================
# LOGGING
# ==============================================
LOG_LEVEL=info
LOG_FORMAT=json

# ==============================================
# FEATURE FLAGS
# ==============================================
ENABLE_SWAGGER=true
SWAGGER_PATH=/docs
ENABLE_REQUEST_LOGGING=true
ENABLE_DETAILED_ERRORS=true

# ==============================================
# SECURITY
# ==============================================
# Enable HTTPS only
FORCE_HTTPS=true

# Security headers
HELMET_ENABLED=true

# ==============================================
# NOTES FOR STAGING
# ==============================================
# 1. Staging mimics production but uses test payment processors
# 2. Use separate Google OAuth credentials for staging
# 3. Sentry helps catch errors before production
# 4. Keep staging environment close to production configuration
# 5. Use staging to test migrations and deployments
# 6. Consider using production data dumps (with PII removed) for testing
# 7. Test payment flows with Stripe test cards
# 8. Monitor performance to predict production behavior
